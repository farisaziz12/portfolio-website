---
import BaseLayout from '../layouts/BaseLayout.astro';
import SpotlightCard from '../components/animations/SpotlightCard.astro';
import ScrollReveal from '../components/animations/ScrollReveal.astro';
import ImpactHero from '../components/impact/ImpactHero.astro';
import { sanityFetch } from '../lib/sanity/client';
import { featuredImpactMetricsQuery } from '../lib/sanity/queries';

interface ImpactCategory {
  _id: string;
  title: string;
  slug: string;
  icon?: string;
  color?: string;
}

interface ImpactMetric {
  _id: string;
  label: string;
  category?: ImpactCategory;
  metricType: string;
  value?: number;
  prefix?: string;
  suffix?: string;
  unit?: string;
  timeWindow?: string;
  previousValue?: number;
  highlightColor?: string;
  sourceNote?: string;
  sourceUrl?: string;
}

// Fetch featured impact metrics for social proof
const impactMetrics = await sanityFetch<ImpactMetric[]>(featuredImpactMetricsQuery).catch(() => []);

const howItWorks = [
  {
    step: '01',
    title: 'Discovery Call',
    description: 'Free 20-minute call to understand your challenges and determine if we\'re a good fit.',
    icon: 'ðŸ“ž',
  },
  {
    step: '02',
    title: 'Tailored Proposal',
    description: 'Based on our call, I\'ll outline a customized engagement with clear deliverables.',
    icon: 'ðŸ“‹',
  },
  {
    step: '03',
    title: 'Deep Work',
    description: 'Focused sessions where we tackle your specific challenges together.',
    icon: 'ðŸŽ¯',
  },
  {
    step: '04',
    title: 'Ongoing Support',
    description: 'Follow-up support to ensure you\'re getting results and staying on track.',
    icon: 'ðŸš€',
  },
];

const faq = [
  {
    question: 'What\'s the difference between consulting and mentorship?',
    answer: 'Consulting is project-focusedâ€”I help you solve specific technical problems or build systems. Mentorship is growth-focusedâ€”I help you level up your skills, navigate career decisions, and become a better engineer.',
  },
  {
    question: 'How do I know which service is right for me?',
    answer: 'If you have a specific project or technical challenge, consulting is the way to go. If you want to grow as an engineer, need career guidance, or want ongoing support, mentorship is better. Not sure? Book a free discovery call.',
  },
  {
    question: 'What\'s your availability?',
    answer: 'I take on a limited number of clients to ensure quality. Current availability variesâ€”book a discovery call to discuss your timeline and needs.',
  },
  {
    question: 'Do you offer refunds?',
    answer: 'Yes. If you\'re not satisfied after our first session, I offer a full refund. I want you to feel confident about working together.',
  },
];
---

<BaseLayout
  title="Services | Faris Aziz"
  description="Technical consulting and mentorship services. From architecture reviews to 1:1 coaching, I help engineers and teams level up."
  pathname="/services"
>
  <!-- Hero Section -->
  <section class="relative min-h-[70vh] flex items-center overflow-hidden">
    <div class="absolute inset-0 grid-pattern opacity-50"></div>
    <div class="absolute inset-0 gradient-mesh"></div>

    <div class="container relative z-10 py-20 md:py-32">
      <div class="max-w-5xl">
        <ScrollReveal>
          <div class="inline-flex items-center gap-2 px-4 py-2 bg-accent/10 rounded-full text-accent text-sm font-medium mb-8">
            <span class="w-2 h-2 rounded-full bg-accent animate-pulse"></span>
            Limited availability
          </div>
        </ScrollReveal>

        <ScrollReveal delay={0.1}>
          <h1 class="hero-title mb-6">
            <span class="block text-ink">Let's work</span>
            <span class="block hero-title--gradient">together.</span>
          </h1>
        </ScrollReveal>

        <ScrollReveal delay={0.2}>
          <p class="text-xl md:text-2xl text-ink-muted max-w-2xl mb-12">
            I help engineers and teams ship better software through hands-on consulting and personalized mentorship.
          </p>
        </ScrollReveal>

        <ScrollReveal delay={0.3}>
          <div class="flex flex-wrap gap-4">
            <a href="#choose-path" class="btn-primary text-lg px-8 py-4 group">
              See how I can help
              <svg class="w-5 h-5 ml-2 group-hover:translate-y-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
              </svg>
            </a>
            <a href="https://cal.com" target="_blank" rel="noopener noreferrer" class="btn-secondary text-lg px-8 py-4">
              Book free call
            </a>
          </div>
        </ScrollReveal>
      </div>
    </div>
  </section>

  <!-- Two Lanes Section -->
  <section id="choose-path" class="section py-20 md:py-28">
    <div class="container">
      <div class="text-center mb-16">
        <ScrollReveal>
          <h2 class="heading-2 mb-4">Choose Your Path</h2>
        </ScrollReveal>
        <ScrollReveal delay={0.1}>
          <p class="text-ink-muted text-lg max-w-2xl mx-auto">
            Whether you need help with a specific project or want to grow as an engineer, I've got you covered.
          </p>
        </ScrollReveal>
      </div>

      <div class="grid md:grid-cols-2 gap-8 max-w-5xl mx-auto">
        <!-- Consulting Lane -->
        <ScrollReveal delay={0.2}>
          <a href="/consulting" class="group block h-full">
            <SpotlightCard
              class="h-full"
              spotlightColor="rgba(99, 102, 241, 0.15)"
              borderColor="rgba(99, 102, 241, 0.5)"
            >
              <div class="p-8 md:p-10 h-full flex flex-col">
                <div class="text-5xl mb-6">ðŸ’¼</div>
                <h3 class="font-display text-2xl md:text-3xl font-bold text-ink mb-4 group-hover:text-accent transition-colors">
                  Consulting
                </h3>
                <p class="text-ink-muted mb-6 flex-grow">
                  Project-focused expertise. Architecture reviews, technical strategy, hands-on implementation, and team enablement.
                </p>
                <div class="space-y-3 mb-8">
                  <div class="flex items-center gap-3 text-sm text-ink-muted">
                    <svg class="w-5 h-5 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    Architecture reviews & audits
                  </div>
                  <div class="flex items-center gap-3 text-sm text-ink-muted">
                    <svg class="w-5 h-5 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    Performance optimization
                  </div>
                  <div class="flex items-center gap-3 text-sm text-ink-muted">
                    <svg class="w-5 h-5 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    Technical strategy & planning
                  </div>
                  <div class="flex items-center gap-3 text-sm text-ink-muted">
                    <svg class="w-5 h-5 text-emerald-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    Team workshops & enablement
                  </div>
                </div>
                <div class="flex items-center text-accent font-medium group-hover:gap-3 transition-all">
                  <span>View consulting offers</span>
                  <svg class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                  </svg>
                </div>
              </div>
            </SpotlightCard>
          </a>
        </ScrollReveal>

        <!-- Mentorship Lane -->
        <ScrollReveal delay={0.3}>
          <a href="/mentorship" class="group block h-full">
            <SpotlightCard
              class="h-full"
              spotlightColor="rgba(236, 72, 153, 0.15)"
              borderColor="rgba(236, 72, 153, 0.5)"
            >
              <div class="p-8 md:p-10 h-full flex flex-col">
                <div class="text-5xl mb-6">ðŸ§­</div>
                <h3 class="font-display text-2xl md:text-3xl font-bold text-ink mb-4 group-hover:text-pink-500 transition-colors">
                  Mentorship
                </h3>
                <p class="text-ink-muted mb-6 flex-grow">
                  Growth-focused guidance. 1:1 coaching, career navigation, skill development, and accountability.
                </p>
                <div class="space-y-3 mb-8">
                  <div class="flex items-center gap-3 text-sm text-ink-muted">
                    <svg class="w-5 h-5 text-pink-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    1:1 coaching sessions
                  </div>
                  <div class="flex items-center gap-3 text-sm text-ink-muted">
                    <svg class="w-5 h-5 text-pink-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    Career strategy & navigation
                  </div>
                  <div class="flex items-center gap-3 text-sm text-ink-muted">
                    <svg class="w-5 h-5 text-pink-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    Code & portfolio reviews
                  </div>
                  <div class="flex items-center gap-3 text-sm text-ink-muted">
                    <svg class="w-5 h-5 text-pink-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    Async support via Slack or email
                  </div>
                </div>
                <div class="flex items-center text-pink-500 font-medium group-hover:gap-3 transition-all">
                  <span>View mentorship offers</span>
                  <svg class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                  </svg>
                </div>
              </div>
            </SpotlightCard>
          </a>
        </ScrollReveal>
      </div>
    </div>
  </section>

  <!-- Social Proof / Impact Section -->
  {impactMetrics && impactMetrics.length > 0 && (
    <section class="section py-20 md:py-28 relative overflow-hidden">
      <div class="absolute inset-0 grid-pattern opacity-30"></div>
      <div class="absolute inset-0 bg-gradient-to-b from-transparent via-surface-overlay/50 to-transparent"></div>

      <div class="container relative z-10">
        <div class="text-center mb-12">
          <ScrollReveal>
            <p class="text-accent font-mono text-sm tracking-wider uppercase mb-3">Track Record</p>
          </ScrollReveal>
          <ScrollReveal delay={0.1}>
            <h2 class="heading-2 mb-4">
              Proven <span class="hero-title--gradient">Results</span>
            </h2>
          </ScrollReveal>
          <ScrollReveal delay={0.2}>
            <p class="text-ink-muted text-lg max-w-2xl mx-auto">
              Results from my work with teams and communities
            </p>
          </ScrollReveal>
        </div>

        <div class="max-w-5xl mx-auto">
          <ImpactHero metrics={impactMetrics.slice(0, 6)} />
        </div>

        <ScrollReveal delay={0.4}>
          <div class="text-center mt-12">
            <a href="/impact" class="inline-flex items-center gap-2 text-ink-muted hover:text-accent font-medium transition-colors">
              See full impact metrics
              <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </a>
          </div>
        </ScrollReveal>
      </div>
    </section>
  )}

  <!-- How It Works -->
  <section class="section py-20 md:py-28">
    <div class="container">
      <div class="text-center mb-16">
        <ScrollReveal>
          <h2 class="heading-2 mb-4">How It Works</h2>
        </ScrollReveal>
        <ScrollReveal delay={0.1}>
          <p class="text-ink-muted text-lg max-w-2xl mx-auto">
            A simple process designed to get you results fast
          </p>
        </ScrollReveal>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-6xl mx-auto">
        {howItWorks.map((item, index) => (
          <ScrollReveal delay={0.1 * index}>
            <div class="relative">
              {/* Connector line */}
              {index < howItWorks.length - 1 && (
                <div class="hidden lg:block absolute top-8 left-[calc(50%+2rem)] w-[calc(100%-4rem)] h-px bg-gradient-to-r from-edge to-transparent"></div>
              )}

              <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-surface-overlay border border-edge mb-6 text-3xl">
                  {item.icon}
                </div>
                <div class="text-xs font-mono text-accent mb-2">{item.step}</div>
                <h3 class="font-display font-bold text-lg text-ink mb-2">{item.title}</h3>
                <p class="text-sm text-ink-muted">{item.description}</p>
              </div>
            </div>
          </ScrollReveal>
        ))}
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="section py-20 md:py-28 bg-surface-overlay/50">
    <div class="container">
      <div class="max-w-3xl mx-auto">
        <div class="text-center mb-16">
          <ScrollReveal>
            <h2 class="heading-2 mb-4">Frequently Asked Questions</h2>
          </ScrollReveal>
        </div>

        <div class="space-y-4">
          {faq.map((item, index) => (
            <ScrollReveal delay={0.1 * index}>
              <details class="group card">
                <summary class="flex items-center justify-between cursor-pointer p-6 font-medium text-ink">
                  {item.question}
                  <svg class="w-5 h-5 text-ink-muted group-open:rotate-180 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                  </svg>
                </summary>
                <div class="px-6 pb-6 text-ink-muted">
                  {item.answer}
                </div>
              </details>
            </ScrollReveal>
          ))}
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="relative overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-br from-accent via-violet-600 to-pink-600"></div>
    <div class="absolute inset-0 grid-pattern opacity-10"></div>

    <div class="container relative z-10 py-24 md:py-32">
      <div class="max-w-4xl mx-auto text-center">
        <ScrollReveal>
          <h2 class="text-4xl md:text-5xl lg:text-6xl font-display font-bold text-white mb-6">
            Ready to level up?
          </h2>
        </ScrollReveal>
        <ScrollReveal delay={0.1}>
          <p class="text-white/80 text-xl mb-10 max-w-2xl mx-auto">
            Let's have a conversation about your goals and how I can help you get there.
          </p>
        </ScrollReveal>

        <ScrollReveal delay={0.2}>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a
              href="https://cal.com"
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-white text-violet-700 font-bold text-lg rounded-xl hover:bg-white/90 transition-all duration-200 hover:scale-105 active:scale-95 shadow-xl"
            >
              Book a free call
              <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </a>
            <a
              href="mailto:hello@farisaziz.com"
              class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-white/10 text-white font-semibold text-lg rounded-xl border border-white/30 hover:bg-white/20 transition-all duration-200"
            >
              Email me instead
            </a>
          </div>
        </ScrollReveal>
      </div>
    </div>
  </section>
</BaseLayout>
